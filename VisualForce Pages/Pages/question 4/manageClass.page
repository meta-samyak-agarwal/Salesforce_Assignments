<apex:page controller="ManageClassExtension">
    <apex:form id="mainForm">
        <apex:pageMessages id="messages"/>
        
        <apex:pageBlock title="Class Management" id="classListBlock">
            <apex:pageBlockButtons location="top">
                <apex:commandButton value="Refresh" action="{!first}" reRender="classListBlock, messages"/>
            </apex:pageBlockButtons>
            
            <!-- Class List Table -->
            <apex:pageBlockTable value="{!classes}" var="cls" id="classTable">
                <apex:column value="{!cls.Id}" headerValue="Class ID"/>
                <apex:column value="{!cls.Name}" headerValue="Class Name"/>
                <apex:column value="{!cls.MaxLimit__c}" headerValue="Max Limit"/>
                <apex:column value="{!cls.My_Count__c}" headerValue="Current Count"/>
                <apex:column headerValue="Actions">
                    <apex:commandButton value="Edit" 
                                      onclick="editRecord('{!cls.Id}'); return false;" 
                                      styleClass="btn-edit"/>
                    <apex:commandButton value="Delete" 
                                      onclick="if(confirm('Are you sure you want to delete this class?')) { deleteRecord('{!cls.Id}'); } return false;" 
                                      styleClass="btn-delete"
                                      style="margin-left: 5px;"/>
                </apex:column>
            </apex:pageBlockTable>
            
            <!-- Pagination -->
            <apex:pageBlockButtons location="bottom">
                <apex:commandButton value="<< First" action="{!first}" disabled="{!NOT(hasPrevious)}" reRender="classListBlock"/>
                <apex:commandButton value="< Previous" action="{!previous}" disabled="{!NOT(hasPrevious)}" reRender="classListBlock"/>
                <apex:outputText value="Page {!pageNumber} of {!totalPages}"/>
                <apex:commandButton value="Next >" action="{!next}" disabled="{!NOT(hasNext)}" reRender="classListBlock"/>
                <apex:commandButton value="Last >>" action="{!last}" disabled="{!NOT(hasNext)}" reRender="classListBlock"/>
            </apex:pageBlockButtons>
        </apex:pageBlock>

        <!-- Edit Form Section -->
        <apex:outputPanel id="editSection">
            <apex:outputPanel rendered="{!showEditForm}">
                <apex:pageBlock title="Edit Class" id="editFormBlock">
                    <apex:pageBlockSection columns="2">
                        <apex:pageBlockSectionItem>
                            <apex:outputLabel value="Class Name"/>
                            <apex:inputField value="{!selectedClass.Name}" required="true"/>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem>
                            <apex:outputLabel value="Max Limit"/>
                            <apex:inputField value="{!selectedClass.MaxLimit__c}" required="true"/>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem>
                            <apex:outputLabel value="Current Count"/>
                            <apex:inputField value="{!selectedClass.My_Count__c}"/>
                        </apex:pageBlockSectionItem>
                      
                    </apex:pageBlockSection>
                    
                    <apex:pageBlockButtons location="bottom">
                        <apex:commandButton value="Save" 
                                          action="{!saveFnc}" 
                                          reRender="editSection, classListBlock, messages"/>
                        <apex:commandButton value="Cancel" 
                                          action="{!cancelFnc}" 
                                          reRender="editSection"/>
                    </apex:pageBlockButtons>
                </apex:pageBlock>
            </apex:outputPanel>
        </apex:outputPanel>

        <!-- Action Functions for AJAX -->
        <apex:actionFunction name="editRecord" action="{!editClassById}" reRender="editSection, messages">
            <apex:param name="editId" assignTo="{!editClassId}" value=""/>
        </apex:actionFunction>

        <apex:actionFunction name="deleteRecord" action="{!deleteClassById}" reRender="classListBlock, messages">
            <apex:param name="deleteId" assignTo="{!deleteClassId}" value=""/>
        </apex:actionFunction>

    </apex:form>
    
    <!-- Custom CSS for better appearance -->
    <style>
        .btn-edit {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
            margin: 2px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .btn-delete {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px;
            margin: 2px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .btn-edit:hover {
            background-color: #45a049;
        }
        
        .btn-delete:hover {
            background-color: #da190b;
        }
    </style>
</apex:page>